schema_version: v0.5.0
dataset_version: v0.1.0

output:
  variables:
    static: [grid_index, static_feature]
    forcing: [time, grid_index, forcing_feature]
  coord_ranges:
    time:
      start: 1990-09-03T00:00
      end: 1990-09-09T00:00
      step: PT1H
  chunking:
    time: 1
  splitting:
    dim: time
    splits:
      train:
        start: 1990-09-03T00:00
        end: 1990-09-06T00:00
        compute_statistics:
          ops: [mean, std, diff_mean, diff_std]
          dims: [grid_index, time]
      val:
        start: 1990-09-06T00:00
        end: 1990-09-07T00:00
      test:
        start: 1990-09-07T00:00
        end: 1990-09-09T00:00
  domain_cropping:
    margin_width_degrees: 10
    interior_dataset_config_path: /iopsstor/scratch/cscs/sadamov/pyprojects_data/neural-lam/test_example/danra/danra.datastore.yaml

inputs:
  era_height_levels:
    path: '/capstor/store/cscs/ERA5/weatherbench2_original'
    dims: [time, longitude, latitude, level]
    variables:
      vertical_velocity:
        level:
          values: [50,100,150,200,250,300,400,500,600,700,850,925,1000]
          units: Pa/s^2
    dim_mapping:
      time:
        method: rename
        dim: time
      forcing_feature:
        method: stack_variables_by_var_name
        dims: [level]
        name_format: "{var_name}{level}hPa"
      grid_index:
        method: stack
        dims: [longitude, latitude]
    target_output_variable: forcing

  era5_surface:
    path: '/capstor/store/cscs/ERA5/weatherbench2_original'
    dims: [time, longitude, latitude, level]
    variables:
      - total_precipitation
    dim_mapping:
      time:
        method: rename
        dim: time
      forcing_feature:
        method: stack_variables_by_var_name
        name_format: "{var_name}"
      grid_index:
        method: stack
        dims: [longitude, latitude]
    target_output_variable: forcing

  era5_forcing:
    path: /iopsstor/scratch/cscs/sadamov/pyprojects_data/neural-lam/derived_vars_dummy_era5.zarr
    dims: [time, lon, lat]
    derived_variables:
      toa_radiation:
        kwargs:
          time: ds_input.time
          lat: ds_input.lat
          lon: ds_input.lon
        function: mllam_data_prep.ops.derive_variable.physical_field.calculate_toa_radiation
      hour_of_day_sin:
        kwargs:
          time: ds_input.time
          component: sin
        function: mllam_data_prep.ops.derive_variable.time_components.calculate_hour_of_day
      hour_of_day_cos:
        kwargs:
          time: ds_input.time
          component: cos
        function: mllam_data_prep.ops.derive_variable.time_components.calculate_hour_of_day
    dim_mapping:
      time:
        method: rename
        dim: time
      latitude:
        method: rename
        dim: lat
      longitude:
        method: rename
        dim: lon
      grid_index:
        method: stack
        dims: [longitude, latitude]
      forcing_feature:
        method: stack_variables_by_var_name
        name_format: "{var_name}"
    target_output_variable: forcing

  era5_static:
    path: '/capstor/store/cscs/ERA5/weatherbench2_original'
    dims: [time, longitude, latitude, level]
    variables:
      - geopotential_at_surface
    dim_mapping:
      static_feature:
        method: stack_variables_by_var_name
        name_format: "{var_name}"
      grid_index:
        method: stack
        dims: [longitude, latitude]
    target_output_variable: static

extra:
  projection:
    class_name: PlateCarree
    kwargs:
      central_longitude: 0.0